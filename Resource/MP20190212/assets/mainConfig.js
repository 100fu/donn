const svgs={
  RPM:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34.85 35"><defs><style>.cls-1{fill:#fff;}</style></defs><title>基础配置</title><g id="图层_2" data-name="图层 2"><g id="图层_1-2" data-name="图层 1"><path class="cls-1" d="M28,11.59,19,29.91a.32.32,0,0,0,.47.4L34.72,19.45a.32.32,0,0,0,.06-.46l-6.24-7.47A.32.32,0,0,0,28,11.59Z"/><path class="cls-1" d="M15.31,1.13V28a.31.31,0,0,0,.6.14L26.63,6.29a.32.32,0,0,0-.15-.43L15.76.84A.32.32,0,0,0,15.31,1.13Z"/><path class="cls-1" d="M.32,35H11.41a.32.32,0,0,0,.32-.32V.32A.32.32,0,0,0,11.41,0H.32A.32.32,0,0,0,0,.32V34.68A.32.32,0,0,0,.32,35Zm5.54-8.95a3.21,3.21,0,1,1,0,6.42,3.21,3.21,0,1,1,0-6.42Z"/></g></g></svg>',
  RtMap:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 35"><defs><style>.cls-1{fill:#fff;}</style></defs><title>实时监控</title><g id="图层_2" data-name="图层 2"><g id="图层_1-2" data-name="图层 1"><path class="cls-1" d="M34.49,0H.51A.51.51,0,0,0,0,.51v28.7a.54.54,0,0,0,.54.54H10.73l-3,4.48a.5.5,0,0,0,.41.77h18.7a.5.5,0,0,0,.41-.77l-3-4.48H34.46a.54.54,0,0,0,.54-.54V.51A.51.51,0,0,0,34.49,0ZM27.76,15.75H24.5a1.76,1.76,0,0,1-1.24-.51l-1.49-1.5-2.61,7.81a1.75,1.75,0,0,1-1.66,1.2h0a1.75,1.75,0,0,1-1.64-1.27l-2.46-8.61L12,15a1.75,1.75,0,0,1-1.46.78H7.24A.24.24,0,0,1,7,15.51v-3a.24.24,0,0,1,.24-.24H9.56l3-4.47a1.75,1.75,0,0,1,3.14.49l1.95,6.81L19.34,10a1.76,1.76,0,0,1,2.9-.69l3,3h2.54a.24.24,0,0,1,.24.24v3A.24.24,0,0,1,27.76,15.75Z"/></g></g></svg>',
  Fence:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 38.62"><defs><style>.cls-1{fill:#fff;}</style></defs><title>电子围栏</title><g id="图层_2" data-name="图层 2"><g id="图层_1-2" data-name="图层 1"><circle class="cls-1" cx="17.5" cy="19.16" r="1.94"/><path class="cls-1" d="M34.94,9.29,34.8,7.73a.35.35,0,0,0-.37-.32l-1.56.12C23.2,8.24,19.25,2.3,19.1,2.09l-1.34-2a.31.31,0,0,0-.5,0l-1.36,2c-.16.22-4.14,6.16-13.77,5.45L.55,7.41a.33.33,0,0,0-.35.3L.06,9.29C0,9.53-1.8,33.06,17,38.47l.54.15.54-.15C36.8,33.06,35,9.53,34.94,9.29ZM19.44,24.62v3.75a.48.48,0,0,1-.48.48H16a.48.48,0,0,1-.48-.48V24.62a5.82,5.82,0,1,1,3.88,0Z"/></g></g></svg>',
  HisTrack:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 35"><defs><style>.cls-1{fill:#fff;}</style></defs><title>历史回放</title><g id="图层_2" data-name="图层 2"><g id="图层_1-2" data-name="图层 1"><path class="cls-1" d="M18,8.75l-1.8,1.8a10.51,10.51,0,0,1,9.52,10.14.3.3,0,0,1-.3.31H22.46a.3.3,0,0,1-.29-.28,7,7,0,0,0-5.86-6.6L18,15.75a.3.3,0,0,1,0,.43l-2,2a.3.3,0,0,1-.43,0L9.71,12.46a.31.31,0,0,1,0-.42l5.76-5.76a.3.3,0,0,1,.43,0l2,2A.3.3,0,0,1,18,8.75Z"/><path class="cls-1" d="M35,27.71V.35A.34.34,0,0,0,34.65,0H.35A.34.34,0,0,0,0,.35V27.71A.29.29,0,0,0,.29,28H8.75v3.5H5.56a.31.31,0,0,0-.31.31v2.88a.31.31,0,0,0,.31.31H29.44a.31.31,0,0,0,.31-.31V31.81a.31.31,0,0,0-.31-.31H26.25V28h8.46A.29.29,0,0,0,35,27.71ZM3.5,24.19V3.81a.31.31,0,0,1,.31-.31H31.19a.31.31,0,0,1,.31.31V24.19a.31.31,0,0,1-.31.31H3.81A.31.31,0,0,1,3.5,24.19Z"/></g></g></svg>',
  HisAlarm:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 35"><defs><style>.cls-1{fill:#fff;}</style></defs><title>报警管理</title><g id="图层_2" data-name="图层 2"><g id="图层_1-2" data-name="图层 1"><path class="cls-1" d="M31.5,31.46v-10A14.29,14.29,0,0,0,18.17,7,14,14,0,0,0,3.5,21V31.46a0,0,0,0,1,0,0h-3A.47.47,0,0,0,0,32v2.54A.47.47,0,0,0,.48,35h34a.47.47,0,0,0,.48-.48V32a.47.47,0,0,0-.48-.48h-3A0,0,0,0,1,31.5,31.46Z"/><rect class="cls-1" x="15.75" width="3.5" height="3.5" rx="0.51"/><rect class="cls-1" x="29.36" y="5.64" width="3.5" height="3.5" rx="0.48" transform="translate(3.89 24.16) rotate(-45)"/><rect class="cls-1" x="2.14" y="5.64" width="3.5" height="3.5" rx="0.3" transform="translate(-4.09 4.91) rotate(-45)"/></g></g></svg>',
  RtView:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 35"><defs><style>.cls-1{fill:#fff;}</style></defs><title>视频联动</title><g id="图层_2" data-name="图层 2"><g id="图层_1-2" data-name="图层 1"><path class="cls-1" d="M.3,15.75H6.91a.28.28,0,0,0,.29-.24A10.53,10.53,0,0,1,15.51,7.2a.29.29,0,0,0,.24-.29V.3a.31.31,0,0,0-.3-.3H.3A.31.31,0,0,0,0,.3V15.45A.31.31,0,0,0,.3,15.75Z"/><path class="cls-1" d="M19.25.3V6.91a.29.29,0,0,0,.24.29,10.53,10.53,0,0,1,8.31,8.31.29.29,0,0,0,.29.24H34.7a.31.31,0,0,0,.3-.3V.3a.31.31,0,0,0-.3-.3H19.55A.31.31,0,0,0,19.25.3Z"/><path class="cls-1" d="M6.91,19.25H.3a.31.31,0,0,0-.3.3V34.7a.31.31,0,0,0,.3.3H15.45a.31.31,0,0,0,.3-.3V28.09a.28.28,0,0,0-.24-.29A10.53,10.53,0,0,1,7.2,19.49.28.28,0,0,0,6.91,19.25Z"/><path class="cls-1" d="M19.25,28.09V34.7a.31.31,0,0,0,.3.3H34.7a.31.31,0,0,0,.3-.3V19.55a.31.31,0,0,0-.3-.3H28.09a.29.29,0,0,0-.29.24,10.53,10.53,0,0,1-8.31,8.31A.28.28,0,0,0,19.25,28.09Z"/><path class="cls-1" d="M15.75,13v9a.3.3,0,0,0,.52.21l4.52-4.52a.31.31,0,0,0,0-.42l-4.52-4.52A.3.3,0,0,0,15.75,13Z"/></g></g></svg>',
  RtXFReg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 35"><defs><style>.cls-1{fill:#fff;}</style></defs><title>点名考勤</title><g id="图层_2" data-name="图层 2"><g id="图层_1-2" data-name="图层 1"><circle class="cls-1" cx="8.75" cy="14" r="5.25"/><rect class="cls-1" width="35" height="3.5" rx="0.3"/><rect class="cls-1" x="17.5" y="7" width="17.5" height="3.5" rx="0.3"/><rect class="cls-1" x="28" y="14" width="7" height="3.5" rx="0.3"/><path class="cls-1" d="M23.6,15.93l-8.2,8.2A8.68,8.68,0,0,0,7.9,21a9,9,0,0,0-7.9,9v4.63A.31.31,0,0,0,.31,35H17.19a.31.31,0,0,0,.31-.31V29.75a8.66,8.66,0,0,0-.38-2.4l9-9a.29.29,0,0,0,0-.42L24,15.93A.29.29,0,0,0,23.6,15.93Z"/></g></g></svg>',
  RMS:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 35"><defs><style>.cls-1{fill:#fff;}</style></defs><title>权限中心</title><g id="图层_2" data-name="图层 2"><g id="图层_1-2" data-name="图层 1"><path class="cls-1" d="M23.5,15.08a8.69,8.69,0,0,0,2.75-6.32,8.75,8.75,0,1,0-17.5,0,8.66,8.66,0,0,0,2.75,6.33A17.52,17.52,0,0,0,0,31.5v3.19A.31.31,0,0,0,.31,35H34.69a.31.31,0,0,0,.31-.31V31.5A17.52,17.52,0,0,0,23.5,15.08Zm2.44,11.17H22.75v3.19a.31.31,0,0,1-.31.31H19.56a.31.31,0,0,1-.31-.31V26.25H16.06a.31.31,0,0,1-.31-.31V23.06a.31.31,0,0,1,.31-.31h3.19V19.56a.31.31,0,0,1,.31-.31h2.88a.31.31,0,0,1,.31.31v3.19h3.19a.31.31,0,0,1,.31.31v2.88A.31.31,0,0,1,25.94,26.25Z"/></g></g></svg>'
}
//import { ModifyPassword } from '../../Index_Actions';
var Cookies = {
  //    getCookieAdapter: function () {
  //        (function () { }).apply(jquery, arguments);
  //    },
  get: function (name) {

      var arr = document.cookie.match(new RegExp("(^| )" + name + "=([^;]*)(;|$)"));

      if (arr != null) return unescape(arr[2]); return null;
  },
  set: function (name, value, expires) {

      this.remove(name);

      var Days = expires || 7;

      var exp = new Date();

      exp.setTime(exp.getTime() + Days * 24 * 60 * 60 * 1000);

      document.cookie = name + "=" + escape(value) + ";expires=" + exp.toGMTString() + ";path=/";
  },
  remove: function (name) {

      var exp = new Date();

      exp.setTime(exp.getTime() - 1);

      var cval = this.get(name);

      if (cval != null) {
          cval = '';
          document.cookie = name + "=" + cval + ";expires=" + exp.toGMTString() + ";path=/";
      }
  }
};
window["user"] = function () {
  return {name:Cookies.get('EAMUSERNAME'),pictureUrl:"",label:Cookies.get('EAMUSERNAME')}
  //return "Admin"
}
window["signOut"] = function () { location.assign("/Home/ExitLogin"); }
window["userCenter"] = function () { this.console.log("userCenter"); }

window["pwReset"] = function () {
 
    this.console.log("pwReset");
  //  document.getElementById("pwd").outerHTML = "";
    $('#pwd').html("");

  var updataPwd = document.createElement('div');
  updataPwd.setAttribute('id', 'upw');

  var oldU = document.createElement('div');
  oldU.setAttribute('id', 'updata_pwd')
  //oldU.setAttribute('class', 'p_up');
  var title = document.createElement('H5');
  title.innerText = "修改密码";
  oldU.append(title);

  //旧密码
  var oldP = document.createElement('div');
  oldP.setAttribute('id', 'old_pwd');
  oldP.setAttribute('class', 'p_up');
  var titleOld = document.createElement('label');
  titleOld.setAttribute('id', 'title_old');
  titleOld.setAttribute('class', 'h6_Password');
  titleOld.innerText = "旧  密  码：";
  var inputOld = document.createElement('input');
  inputOld.setAttribute('id', 'input_old');
  inputOld.setAttribute('class', 'input_Password');
  inputOld.setAttribute('type', 'password');
  //placeholder
  inputOld.placeholder = "请输入旧密码";

  oldP.append(titleOld);
  oldP.append(inputOld);
  //新密码
  var oldN = document.createElement('div');
  oldN.setAttribute('id', 'new_pwd')
  oldN.setAttribute('class', 'p_up');
  var titleNew = document.createElement('label');
  titleNew.setAttribute('id', 'title_new');
  titleNew.setAttribute('class', 'h6_Password');
  titleNew.innerText = "新  密  码：";
  var inputNew = document.createElement('input');
  inputNew.setAttribute('id', 'input_new');
  inputNew.setAttribute('class', 'input_Password');
  inputNew.setAttribute('type', 'password');
  inputNew.placeholder = "请输入新密码";
  oldN.append(titleNew);
  oldN.append(inputNew);

  //确认密码
  var oldC = document.createElement('div');
  oldC.setAttribute('id', 'confirm_pwd')
  oldC.setAttribute('class', 'p_up');
  var titleConfirm = document.createElement('label');
  titleConfirm.setAttribute('id', 'title_confirm');
  titleConfirm.setAttribute('class', 'h6_Password');
  titleConfirm.innerText = "确认密码：";
  var inputConfirm = document.createElement('input');
  inputConfirm.setAttribute('id', 'input_confirm');
  inputConfirm.setAttribute('class', 'input_Password');
  inputConfirm.setAttribute('type', 'password');
  inputConfirm.placeholder = "请输入确认密码";
  oldC.append(titleConfirm);
  oldC.append(inputConfirm);

  //显示错误信息
  var oldM = document.createElement('div');
  oldM.setAttribute('id', 'message_pwd');
  oldM.setAttribute('class', 'p_up');

  updataPwd.append(oldU);
  updataPwd.append(oldP);
  updataPwd.append(oldN);
  updataPwd.append(oldC);
  updataPwd.append(oldM);


  var inputP = document.createElement('input');
  inputP.setAttribute('id', 'inpwdP');
  inputP.setAttribute('type', 'button');
  inputP.value = "取消";
  inputP.onclick = function () {
      updataPwd.style.display = "none";
      lucency.style.display = "none";

  }
  
  var inputS = document.createElement('input');
  inputS.setAttribute('id', 'inpwdS');
  inputS.setAttribute('type', 'button');
  inputS.value = "确定";
  inputS.onclick = function () {
      var confirm_Pwd = inputConfirm.value;
      var new_Pwd = inputNew.value;
      var old_Pwd = inputOld.value;

      if (old_Pwd != "") {
          if (new_Pwd != "") {
              if (confirm_Pwd != "") {
                  if (new_Pwd == confirm_Pwd) {
                      oldM.innerText = "";
                      //let old_pwd = "";
                      //let new_pwd = "";
                      //var urlPathPwd = "UserController/UpdatePassword";
                      //$.ajax({
                      //    type: "post",
                      //    url: "User/UpdatePassword",
                      //    data: { oldPwd: old_Pwd, newPwd: new_Pwd },
                      //    cont
                      //    success: function (data) {
                      //        //$(".show").val(data.d);
                      //        alert(new_pwd);
                      //    }                         

                      //}),
                      let strJson = { "oldPwd": old_Pwd, "newPwd": new_Pwd }
                      $.ajax({
                          type: "post", caches:false,
                          url: "/User/UpdatePassword",
                          data: strJson,
                          success: function (data) {
                              //$(".show").val(data.d);
                              if (data.Data) {
                                  alert("密码修改成功！");
                              }
                                  
                              else {
                                  alert("密码修改失败！");
                              }
                          },
                          async: false
                      });
                      //})
                      //let urlPath = "/User/UpdatePassword";
                      //let strJson = { oldPwd: old_Pwd, newPwd: new_Pwd };
                      //new Ajax({ url: urlPath, data: strJson, contentType: "json", type:"post" }).done(d => {
                      //    alert("121212");
                      //});


                      
                      updataPwd.style.display = "none";
                      lucency.style.display = "none";
                      

                  } else {
                      oldM.innerText = "*新密码和确认密码不符！";
                  }
              } else {
                  oldM.innerText = "*确认密码不能为空！";
              }
          } else {
              oldM.innerText = "*新密码不能为空！";
          }
      } else {
          oldM.innerText = "*旧密码不能为空！";
      }
     
      
  }
  updataPwd.append(inputS);
  updataPwd.append(inputP);    
  var lucency = document.createElement('div');
  lucency.setAttribute('id', 'lucency');

  $("#pwd").append($(lucency));
  $("#pwd").append($(updataPwd));
  //jQuery("#pwd").html($(updataPwd));
  //jQuery("#pwd").dialog({
  //    title: '修改密码',
  //    modal: true,
  //    autoOpen: true,
  //    width: 500,
  //    position: ['center', 50],
  //    close: function (event, ui) {
  //        isdraw = true;
  //        $("#formEditDialog").dialog("destroy");
  //        $("#formEditDialog").html("");
  //    }
  //});

}
function passWord() {
    alert('121212');
}

window["setting"] = function () { this.console.log("setting"); }
window["userInfos"] = function () {
  var s = [
    {
      class: "userCenter", name: "退出", callback: () => {
        window["signOut"]();
      },svg:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="camera-retro" class="svg-inline--fa fa-camera-retro fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 32C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48H48zm0 32h106c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H38c-3.3 0-6-2.7-6-6V80c0-8.8 7.2-16 16-16zm426 96H38c-3.3 0-6-2.7-6-6v-36c0-3.3 2.7-6 6-6h138l30.2-45.3c1.1-1.7 3-2.7 5-2.7H464c8.8 0 16 7.2 16 16v74c0 3.3-2.7 6-6 6zM256 424c-66.2 0-120-53.8-120-120s53.8-120 120-120 120 53.8 120 120-53.8 120-120 120zm0-208c-48.5 0-88 39.5-88 88s39.5 88 88 88 88-39.5 88-88-39.5-88-88-88zm-48 104c-8.8 0-16-7.2-16-16 0-35.3 28.7-64 64-64 8.8 0 16 7.2 16 16s-7.2 16-16 16c-17.6 0-32 14.4-32 32 0 8.8-7.2 16-16 16z"></path></svg>'
    },
      //     {
      //   class: "userCenter", name: "个人中心", callback: () => {
      //     window["userCenter"]();
      //   }
      // }
      //, 
      {
          class: "pwReset", name: "修改密码", callback: () => {
              window["pwReset"]();
             // passWord();
         
      },svg:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="camera-retro" class="svg-inline--fa fa-camera-retro fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 32C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48H48zm0 32h106c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H38c-3.3 0-6-2.7-6-6V80c0-8.8 7.2-16 16-16zm426 96H38c-3.3 0-6-2.7-6-6v-36c0-3.3 2.7-6 6-6h138l30.2-45.3c1.1-1.7 3-2.7 5-2.7H464c8.8 0 16 7.2 16 16v74c0 3.3-2.7 6-6 6zM256 424c-66.2 0-120-53.8-120-120s53.8-120 120-120 120 53.8 120 120-53.8 120-120 120zm0-208c-48.5 0-88 39.5-88 88s39.5 88 88 88 88-39.5 88-88-39.5-88-88-88zm-48 104c-8.8 0-16-7.2-16-16 0-35.3 28.7-64 64-64 8.8 0 16 7.2 16 16s-7.2 16-16 16c-17.6 0-32 14.4-32 32 0 8.8-7.2 16-16 16z"></path></svg>'
         
      }
      //,
      // {
      //   class: "setting", name: "软件配置", callback: () => {
      //     window["setting"]();
      //   }
      // }
  ];
  return s;
}
window["menus"] = function () {
  var a = [];
  var MenuAdapter = function (d) {
      var result = [];
      d.forEach(i => {
          let obj = {};
          if (i.menus) obj.children = MenuAdapter(i.menus);
          obj.code = i.Code;//d.IdPrivilege;
          if (obj.code === 'RtMap') {
              obj.float = true;
          }
          obj.svg=svgs[obj.code];
          obj.name = i.menuname;
          obj.url = i.url;
          obj.class = i.objname;
          result.push(obj);
      });
      return result.length==0?undefined:result;
  }
  $.ajax("/Home/GerArchMenus_new", {
      async: false, type: "POST", success: (d) => {
          a = MenuAdapter(d);
      }
  })
  //a=[{
  //  class: "monitor",
  //  name: "实时监控",
  //  url: "https://www.baidu.com",
  //  code: "monitor",
  //  children:[{
  //    class: "monitor",
  //    name: "实时监控",
  //    url: "https://www.baidu.com",
  //    code: "monitor",
  //  }, {
  //      class: "tagManager",
  //      name: "标签管理",
  //      url: "https://www.baidu.com",
  //      code: "tagManager"
  //    }]
  //}]
  //a.push({
  //  class: "monitor",
  //  name: "实时监控",
  //  url: "https://www.baidu.com",
  //  code: "monitor"
  //})
  return a;
  // return [{
  //   class: "monitor",
  //   name: "实时监控",
  //   url: "https://www.baidu.com",
  //   code: "monitor",
  //   target:"baidu_first"
  // }, {
  //   class: "tagManager",
  //   name: "标签管理",
  //   url: "https://www.baidu.com",
  //   code: "tagManager"
  // }, {
  //   class: "history",
  //   name: "历史回放",
  //   url: "https://www.baidu.com",
  //   code: "history"
  // }, {
  //   class: "warnning",
  //   name: "报警管理",
  //   url: "https://www.baidu.com",
  //   code: "warnning"
  // }, {
  //   class: "dataAnalysis",
  //   name: "数据分析",
  //   url: "https://www.baidu.com",
  //   code: "dataAnalysis"
  // }, {
  //   class: "vadio",
  //   name: "视频联动",
  //   url: "https://www.baidu.com",
  //   code: "vadio"
  // }, {
  //   class: "eleMention",
  //   name: "电子点名",
  //   url: "https://www.baidu.com",
  //   code: "eleMention"
  // }];
}
// window["defaultPage"]=function(){
//   return ""
// }
window["defaultMainPage"]=function(){
    return "RtMap"
}
